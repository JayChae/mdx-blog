# Simple SPA

현재 CLI를 통하여 거래를 만들고 블록을 채굴할 수 있습니다. 그러나 CLI에 명령어를 치는 것보다 UI를 통하여 사용하면 더 편하겠죠? SPA(Single Page Application)를 도입해 사용성을 개선해 봅시다.

## SPA(Single Page Application)이란?

SPA(싱글 페이지 애플리케이션)는 전통적인 다중 페이지 방식(Multi-Page Application, MPA)과 달리
초기 로드 시 하나의 HTML 페이지와 자바스크립트 번들을 받아온 뒤,
이후의 화면 전환은 서버로부터 전체 페이지를 다시 로드하지 않고 클라이언트(브라우저)에서 자바스크립트로 라우팅과 뷰 업데이트를 처리하는 웹 애플리케이션입니다.

### SPA의 동작 원리 (간단히)

1. 사용자가 앱에 접속하면 초기 HTML/CSS/JS 번들을 로드합니다.
2. URL을 감지하여 적절한 컴포넌트를 렌더링합니다.

## 요구사항

### home("/")

explorer로 이동하는 버튼
wallet으로 이동하는 버튼
간단한 설명

<img
  width=""
  height=""
  alt="image"
  src="https://github.com/user-attachments/assets/5f6acc1b-d28d-4f8c-a1b4-c4a09c27bc09"
/>

### explorer("/explorer")

블록체인 확인  
블록 검색 bt index or hash

<img
  width=""
  height=""
  alt="image"
  src="https://github.com/user-attachments/assets/b86f67f2-cf20-4cc9-a72c-4875542a84a6"
/>

### wallet("/wallet")

잔고 확인  
주소 확인  
코인 보내기

<img
  width=""
  height=""
  alt="image"
  src="https://github.com/user-attachments/assets/5a299a08-b5b8-41b5-af90-b62fee206bf3"
/>

### mempool & peers & mining(explorer와 wallet 페이지 하단)

mempool 확인  
연결된 노드 확인  
블록 채굴(mempool transaction 블록에 담기)

<img
  width=""
  height=""
  alt="image"
  src="https://github.com/user-attachments/assets/622fe360-a7a3-49b6-b20b-ddf78103eda3"
/>

## SPA를 위한 endpoints

SPA(Single Page Application)을 지원하기 위해 Express 서버에서 라우팅을 처리하는 방식입니다.

### 정적 파일 제공

`public` 디렉토리를 정적 파일 제공 폴더로 지정합니다. 따라서 html, JS 같은 정적 자원은 별도의 라우팅 없이 자동으로 서비스됩니다.

```ts
app.use(express.static(path.join(__dirname, '..', 'public')))
```

### 모든 경로를 index.html로 처리

```ts
app.get('/explorer', (req, res) => {
  res.sendFile(path.join(__dirname, '..', 'public', 'index.html'))
})

app.get('/wallet', (req, res) => {
  res.sendFile(path.join(__dirname, '..', 'public', 'index.html'))
})
```

👉 사용자가 `/explorer`, `/wallet` 경로로 접근했을 때, 실제 서버에 `/explorer.html`와 `/wallet.html`이 아닌 `index.html`을 응답으로 줍니다. SPA는 index.html 안에서 해당 경로에 맞는 컴포넌트를 렌더링합니다.

```ts
app.get('/wallet', (req, res) => {
  res.sendFile(path.join(__dirname, '..', 'public', 'index.html'))
})
```

## 정적 파일(html, js)

### tailwind css

디자인은 tailwind를 사용하고 CDN을 통해 가져옵니다.

```html
<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <!-- tailwind -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Simple Coin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="bg-white min-h-screen">
    .....
  </body>
</html>
```

### html

모든 경로의 UI를 작성 후 차후 자바스크립트로 해당 경로에 해당하는 컴포넌트를 js로 렌더링합니다.

```html
<!DOCTYPE html>
<html>
  <head>
    ...
  </head>
  <body class="bg-white min-h-screen">
    <!-- Header -->
    <header class="bg-gray-50 shadow-md border-b border-gray-300">...</header>

    <!-- Home Page -->
    <div id="homePage" class="page active">...</div>

    <!-- Explorer Page -->
    <div id="explorerPage" class="page">...</div>

    <!-- Wallet Page -->
    <div id="walletPage" class="page">...</div>
  </body>
</html>
```

### js

```html
...
    <!-- JavaScript Modules -->

     <!-- api handlers -->
    <script src="js/api.js"></script>

    <!-- UI 렌더링 관련 함수들 -->
    <script src="js/navigation.js"></script>

    <!-- Api로 받은 결과 렌더링 -->
    <script src="js/ui.js"></script>

    <!-- 메인 애플리케이션 로직 -->
    <script src="js/app.js"></script>
  </body>
</html>
```

## 확인

```bash
npm start
```

http://localhost:3001/ 에 들어가면 확인할 수 있습니다.

이제는 UI로 블록체인,잔고,주소를 확인하고 블록을 채굴하거나 거래를 발생 시킬 수 있습니다.

## 다음 챕터

현재는 연결된 노드가 없습니다. 블록체인 네트워크가 잘 동작하는지, 서로 거래를 주고 받을 수 있는지 확인할 수가 없습니다. 혼자서도 거래를 주고받아 볼 수 있도록 도커를 사용해서 node를 여러 개를 띄워 보겠습니다.
